<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø±Ù…Ø¶Ø§Ù† 2026 - Ù„ÙˆØ­Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© | Ø¹Ù…Ø§Ù†</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700;900&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/adhan@4.4.3/lib/bundles/adhan.umd.min.js"></script>

    <style>
        :root {
            --bg-dark: #0f172a;
            --bg-card: rgba(30, 41, 59, 0.6);
            --accent-gold: #fbbf24;
            --accent-blue: #3b82f6;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --glass-border: 1px solid rgba(255, 255, 255, 0.15);
            --font-main: 'Tajawal', sans-serif;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-dark);
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(251, 191, 36, 0.08) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(59, 130, 246, 0.08) 0%, transparent 20%);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 30px 20px;
        }

        .moon-bg {
            position: fixed;
            top: -100px;
            left: -100px;
            width: 400px;
            height: 400px;
            background: radial-gradient(circle, var(--accent-gold) 10%, transparent 60%);
            opacity: 0.05;
            filter: blur(80px);
            animation: floatMoon 20s infinite alternate ease-in-out;
            z-index: -1;
        }

        @keyframes floatMoon {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }

        .dashboard-container {
            width: 100%;
            max-width: 1200px;
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 20px;
            position: relative;
        }

        /* Ù‚Ø³Ù… Ø§Ù„ØªØ­ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ© */
        .greeting-section {
            grid-column: span 12;
            text-align: center;
            margin-bottom: 10px;
            animation: fadeIn 1s ease-in-out;
        }
        .greeting-title { font-size: 2rem; font-weight: 900; margin-bottom: 5px; }
        .encouraging-text { font-size: 1.1rem; color: #cbd5e1; font-weight: 400; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }

        /* ØªØµÙ…ÙŠÙ… Ø¨Ø·Ø§Ù‚Ø§Øª Ø£Ø¨Ù„ (Apple Widgets) */
        .apple-widget {
            background: var(--bg-card);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: var(--glass-border);
            border-radius: 28px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s ease;
        }
        .apple-widget:hover { transform: scale(1.02); }
        .widget-title { font-size: 0.9rem; color: var(--text-secondary); margin-bottom: 8px; font-weight: 700; }
        .widget-value { font-size: 1.3rem; font-weight: 900; color: var(--text-primary); }
        .widget-value.gold { color: var(--accent-gold); }

        .widget-container { grid-column: span 12; display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }

        .card {
            background: var(--bg-card);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
            border: var(--glass-border);
            border-radius: 24px;
            padding: 24px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card:hover { box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.4); border-color: rgba(251, 191, 36, 0.3); }

        .main-stat-card { grid-column: span 4; display: flex; flex-direction: column; justify-content: center; text-align: center; }
        .progress-card { grid-column: span 8; display: flex; flex-direction: column; justify-content: space-around; }
        .ramadan-month-card { grid-column: span 12; }
        .work-card { grid-column: span 6; display: flex; flex-direction: column; justify-content: center; }
        .prayers-list-card { grid-column: span 6; }

        h2 { font-size: 1.2rem; margin-bottom: 15px; color: var(--text-secondary); display: flex; align-items: center; justify-content: space-between; width: 100%; }
        .big-number { font-size: 3.5rem; font-weight: 700; line-height: 1; margin: 15px 0; text-shadow: 0 0 20px rgba(251, 191, 36, 0.3); }
        .sub-text { font-size: 0.9rem; color: var(--text-secondary); }
        
        .progress-container { margin-top: 15px; }
        .progress-label { display: flex; justify-content: space-between; margin-bottom: 8px; font-weight: bold; }
        .progress-bar-bg { width: 100%; height: 12px; background: rgba(255,255,255,0.05); border-radius: 10px; overflow: hidden; }
        
        .progress-bar-fill { height: 100%; border-radius: 10px; transition: width 1s linear; position: relative; }
        .fasting-fill { background: linear-gradient(90deg, #1e3a8a 0%, var(--accent-gold) 100%); box-shadow: 0 0 15px var(--accent-gold); }
        .work-fill { background: linear-gradient(90deg, #059669 0%, #34d399 100%); }

        .prayer-item {
            display: flex; justify-content: space-between; padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); transition: background 0.3s; border-radius: 8px;
        }
        .prayer-item:last-child { border-bottom: none; }
        .prayer-item.active { background: rgba(251, 191, 36, 0.15); border-right: 3px solid var(--accent-gold); }
        .prayer-name { font-weight: bold; }
        .prayer-time { font-family: 'Courier New', Courier, monospace; letter-spacing: 1px; }

        /* Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª (Modal) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(5px);
            display: none; justify-content: center; align-items: center; z-index: 100;
        }
        .modal-content {
            background: var(--bg-dark); padding: 30px; border-radius: 20px; border: 1px solid var(--accent-gold); width: 90%; max-width: 400px; text-align: center;
        }
        .modal-content input {
            width: 100%; padding: 10px; margin: 10px 0 20px; border-radius: 8px; border: 1px solid #334155; background: #1e293b; color: white; font-size: 1.1rem; text-align: center; font-family: 'Tajawal', monospace;
        }
        .modal-content button {
            background: var(--accent-gold); color: #000; font-weight: bold; border: none; padding: 12px 30px; border-radius: 8px; cursor: pointer; font-family: 'Tajawal'; font-size: 1.1rem; width: 100%; transition: 0.2s;
        }
        .modal-content button:hover { background: #d97706; }
        .settings-btn { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 1.2rem; transition: 0.2s; }
        .settings-btn:hover { color: var(--accent-gold); transform: rotate(45deg); }

        .celebration-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; pointer-events: none; z-index: 10; display: none; }
        .confetti { width: 10px; height: 10px; background: gold; position: absolute; animation: fall 3s linear infinite; }
        @keyframes fall { 0% { transform: translateY(-10px) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

        @media (max-width: 900px) {
            .dashboard-container { display: flex; flex-direction: column; gap: 15px; }
            .widget-container { grid-template-columns: 1fr; gap: 10px; }
            .main-stat-card, .progress-card, .ramadan-month-card, .work-card, .prayers-list-card { width: 100%; }
            .big-number { font-size: 2.8rem; }
            .greeting-title { font-size: 1.6rem; }
        }
    </style>
</head>
<body>

    <div class="moon-bg"></div>

    <div id="settings-modal" class="modal-overlay">
        <div class="modal-content">
            <h2 style="justify-content: center; color: var(--accent-gold); margin-bottom: 20px;">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø®ØµÙŠØ©</h2>
            <div style="text-align: right;">
                <label>Ø§Ù„Ø§Ø³Ù…:</label>
                <input type="text" id="user-name-input" value="" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ù‡Ù†Ø§" required>

                <label>ÙˆÙ‚Øª Ø¨Ø¯Ø¡ Ø§Ù„Ø¯ÙˆØ§Ù…:</label>
                <input type="time" id="start-time-input" value="07:30" required>
                
                <label>ÙˆÙ‚Øª Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ§Ù…:</label>
                <input type="time" id="end-time-input" value="14:30" required>
            </div>
            <button onclick="saveSettings()">Ø­ÙØ¸ ÙˆØ¥ØºÙ„Ø§Ù‚</button>
        </div>
    </div>

    <div class="dashboard-container">
        
        <div class="greeting-section">
            <h1 class="greeting-title">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ<span id="display-name" style="color: var(--accent-gold);"></span> âœ¨</h1>
            <p id="encouraging-message" class="encouraging-text">Ø±Ù…Ø¶Ø§Ù† Ù…Ø¨Ø§Ø±ÙƒØŒ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹Ø§ØªÙƒÙ…</p>
        </div>

        <div class="widget-container">
            <div class="apple-widget">
                <div class="widget-title">Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù‡Ø¬Ø±ÙŠ</div>
                <div id="hijri-date" class="widget-value gold">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
            </div>
            <div class="apple-widget">
                <div class="widget-title">Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ÙŠ</div>
                <div id="gregorian-date" class="widget-value">-</div>
            </div>
            <div class="apple-widget">
                <div class="widget-title">Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø¹ÙŠØ¯</div>
                <div id="days-left" class="widget-value" style="color: var(--accent-blue);">-</div>
            </div>
        </div>

        <div class="card main-stat-card">
            <h2 style="justify-content: center;">Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: <span id="next-prayer-name" style="color:var(--text-primary); margin-right: 5px;">-</span></h2>
            <div id="countdown" class="big-number">00:00:00</div>
            <div class="sub-text">Ù…ØªØ¨Ù‚ÙŠ Ù„Ù„Ø£Ø°Ø§Ù†</div>
        </div>

        <div class="card progress-card" style="position: relative; overflow: hidden;">
            <div class="celebration-overlay" id="celebration"></div>
            <div class="progress-container">
                <div class="progress-label">
                    <span>Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„ØµÙŠØ§Ù… Ø§Ù„ÙŠÙˆÙ…</span>
                    <span id="fasting-percentage" style="color: var(--accent-gold); font-family: monospace; font-size: 1.1rem;">0.000000%</span>
                </div>
                <div class="progress-bar-bg">
                    <div id="fasting-bar" class="progress-bar-fill fasting-fill" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <div class="card ramadan-month-card">
            <h2 style="justify-content: center;">ğŸŒ™ Ø¥Ù†Ø¬Ø§Ø² Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù†</h2>
            <div class="progress-container">
                <div class="progress-label">
                    <span id="ramadan-days-text">Ø§Ù„ÙŠÙˆÙ… - Ù…Ù† 30</span>
                    <span id="ramadan-month-percentage" style="color: var(--accent-gold); font-family: monospace; font-size: 1.1rem;">0.00%</span>
                </div>
                <div class="progress-bar-bg">
                    <div id="ramadan-month-bar" class="progress-bar-fill fasting-fill" style="width: 0%;"></div>
                </div>
            </div>
        </div>

        <div class="card work-card">
            <h2>
                <span>ğŸ“Š ØªØªØ¨Ø¹ Ø§Ù„Ø¯ÙˆØ§Ù…</span>
                <button class="settings-btn" onclick="openSettings()" title="ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª">âš™ï¸</button>
            </h2>
            <div id="work-content" style="text-align: center; margin-top: 10px;">
                <div id="work-main-display">
                    <div id="work-countdown" class="big-number" style="color: var(--text-primary); text-shadow: 0 0 20px rgba(5, 150, 105, 0.3);">00:00:00</div>
                    <div class="sub-text" id="work-status-label">Ù…ØªØ¨Ù‚ÙŠ Ù„Ù†Ù‡Ø§ÙŠØ© Ø¯ÙˆØ§Ù…Ùƒ</div>
                </div>
                
                <div class="progress-container">
                    <div class="progress-label">
                        <span id="work-status-text">Ù†Ø³Ø¨Ø© Ø¥Ù†Ø¬Ø§Ø² Ø§Ù„Ø¹Ù…Ù„</span>
                        <span id="work-percentage" style="color: #34d399; font-family: monospace; font-size: 1.1rem;">0.000000%</span>
                    </div>
                    <div class="progress-bar-bg">
                        <div id="work-bar" class="progress-bar-fill work-fill" style="width: 0%;"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card prayers-list-card">
            <h2 style="justify-content: center;">ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„ÙŠÙˆÙ…</h2>
            <div id="prayers-list"></div>
        </div>
    </div>

    <script>
        const els = {
            hijri: document.getElementById('hijri-date'),
            gregorian: document.getElementById('gregorian-date'),
            daysLeft: document.getElementById('days-left'),
            nextPrayerName: document.getElementById('next-prayer-name'),
            countdown: document.getElementById('countdown'),
            fastingPercent: document.getElementById('fasting-percentage'),
            fastingBar: document.getElementById('fasting-bar'),
            ramadanDaysText: document.getElementById('ramadan-days-text'),
            ramadanMonthPercent: document.getElementById('ramadan-month-percentage'),
            ramadanMonthBar: document.getElementById('ramadan-month-bar'),
            workContent: document.getElementById('work-content'),
            workCountdown: document.getElementById('work-countdown'),
            workStatusLabel: document.getElementById('work-status-label'),
            workPercent: document.getElementById('work-percentage'),
            workBar: document.getElementById('work-bar'),
            prayersList: document.getElementById('prayers-list'),
            celebration: document.getElementById('celebration'),
            modal: document.getElementById('settings-modal'),
            nameInput: document.getElementById('user-name-input'),
            startInput: document.getElementById('start-time-input'),
            endInput: document.getElementById('end-time-input'),
            displayName: document.getElementById('display-name'),
            encouragingMessage: document.getElementById('encouraging-message')
        };

        let coords, params;
        let userNameStr = "";
        let workStartTimeStr = "07:30";
        let workEndTimeStr = "14:30";

        function init() {
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­
            const savedName = localStorage.getItem('ramadanUserName');
            const savedStart = localStorage.getItem('ramadanWorkStart');
            const savedEnd = localStorage.getItem('ramadanWorkEnd');
            
            if (savedName && savedStart && savedEnd) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù‚Ø¯ Ø£Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙ‡ Ù…Ø³Ø¨Ù‚Ø§Ù‹
                userNameStr = savedName;
                workStartTimeStr = savedStart;
                workEndTimeStr = savedEnd;
                els.displayName.innerText = "ØŒ " + userNameStr;
            } else {
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø§Ù„Ø²ÙŠØ§Ø±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                els.displayName.innerText = "";
                openSettings();
            }

            if (typeof adhan === 'undefined') {
                els.hijri.innerText = 'Ø®Ø·Ø£ Ø§ØªØµØ§Ù„';
                return;
            }

            coords = new adhan.Coordinates(31.9539, 35.9106); // Ø¹Ù…Ø§Ù†
            params = adhan.CalculationMethod.MuslimWorldLeague();
            params.fajrAngle = 18;
            params.ishaAngle = 18;
            params.madhab = adhan.Madhab.Shafi;

            updateDashboard();
            setInterval(updateTick, 1000);
        }

        function openSettings() {
            els.nameInput.value = userNameStr;
            els.startInput.value = workStartTimeStr;
            els.endInput.value = workEndTimeStr;
            els.modal.style.display = 'flex';
        }

        function saveSettings() {
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ù… ÙŠØªØ±Ùƒ Ø®Ø§Ù†Ø© Ø§Ù„Ø§Ø³Ù… ÙØ§Ø±ØºØ©
            if(els.nameInput.value.trim() !== "" && els.startInput.value && els.endInput.value) {
                userNameStr = els.nameInput.value.trim();
                workStartTimeStr = els.startInput.value;
                workEndTimeStr = els.endInput.value;
                
                // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                localStorage.setItem('ramadanUserName', userNameStr);
                localStorage.setItem('ramadanWorkStart', workStartTimeStr);
                localStorage.setItem('ramadanWorkEnd', workEndTimeStr);
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
                els.displayName.innerText = "ØŒ " + userNameStr;
                els.modal.style.display = 'none';
                updateTick(); 
            } else {
                // ØªÙ†Ø¨ÙŠÙ‡ ÙÙŠ Ø­Ø§Ù„ ØªØ±Ùƒ Ø§Ù„Ø®Ø§Ù†Ø§Øª ÙØ§Ø±ØºØ©
                alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ ÙˆØ£ÙˆÙ‚Ø§Øª Ø§Ù„Ø¯ÙˆØ§Ù… Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø© âœ¨");
            }
        }

        function updateDashboard() {
            const date = new Date();
            const prayerTimes = new adhan.PrayerTimes(coords, date, params);
            
            const hijriDateCalc = new Date(date.getTime() - (24 * 60 * 60 * 1000));
            try {
                const hijriFormatter = new Intl.DateTimeFormat('ar-SA-u-ca-islamic', { day: 'numeric', month: 'long', year: 'numeric' });
                let formatted = hijriFormatter.format(hijriDateCalc);
                els.hijri.innerText = formatted.replace('Ù‡Ù€', '').trim();
            } catch (error) {
                els.hijri.innerText = "Ø±Ù…Ø¶Ø§Ù† 1447"; 
            }
            
            try {
                const gregFormatter = new Intl.DateTimeFormat('ar-JO', { weekday: 'long', day: 'numeric', month: 'short' });
                els.gregorian.innerText = gregFormatter.format(date);
            } catch (error) {
                els.gregorian.innerText = date.toLocaleDateString('ar-JO');
            }
            
            const endRamadan = new Date('2026-03-21');
            const diffTime = Math.abs(endRamadan - date);
            const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)); 
            els.daysLeft.innerText = `${diffDays} ÙŠÙˆÙ…`;

            renderPrayersList(prayerTimes);
        }

        function renderPrayersList(times) {
            els.prayersList.innerHTML = '';
            const imsakTime = new Date(times.fajr.getTime() - 10 * 60000);
            
            const schedule = [
                { id: 'fajr', name: 'Ø§Ù„ÙØ¬Ø±', time: times.fajr },
                { id: 'sunrise', name: 'Ø§Ù„Ø´Ø±ÙˆÙ‚', time: times.sunrise },
                { id: 'dhuhr', name: 'Ø§Ù„Ø¸Ù‡Ø±', time: times.dhuhr },
                { id: 'asr', name: 'Ø§Ù„Ø¹ØµØ±', time: times.asr },
                { id: 'maghrib', name: 'Ø§Ù„Ù…ØºØ±Ø¨', time: times.maghrib },
                { id: 'isha', name: 'Ø§Ù„Ø¹Ø´Ø§Ø¡', time: times.isha },
            ];

            const now = new Date();
            let nextPrayerFound = false;

            schedule.forEach(p => {
                const div = document.createElement('div');
                div.className = 'prayer-item';
                const timeStr = p.time.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: false });
                
                if (!nextPrayerFound && p.time > now && p.id !== 'sunrise') {
                    div.classList.add('active');
                    nextPrayerFound = true;
                    els.nextPrayerName.innerText = p.name;
                    window.nextPrayerTime = p.time;
                }
                div.innerHTML = `<span class="prayer-name">${p.name}</span><span class="prayer-time">${timeStr}</span>`;
                els.prayersList.appendChild(div);
            });

            if (!nextPrayerFound) {
                const tomorrow = new Date(now);
                tomorrow.setDate(tomorrow.getDate() + 1);
                const nextTimes = new adhan.PrayerTimes(coords, tomorrow, params);
                els.nextPrayerName.innerText = 'ÙØ¬Ø± Ø§Ù„ØºØ¯';
                window.nextPrayerTime = nextTimes.fajr;
            }
        }

        function updateEncouragement(now, fajr, maghrib) {
            if (now < fajr) {
                els.encouragingMessage.innerText = "Ù„Ø§ ØªÙ†Ø³Ù Ù†ÙŠØ© Ø§Ù„ØµÙŠØ§Ù… ÙˆØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø³Ø­ÙˆØ±ØŒ ÙŠØ¨Ø§Ø±Ùƒ Ø§Ù„Ù„Ù‡ ÙÙŠ ÙŠÙˆÙ…Ùƒ ğŸŒ™";
            } else if (now >= fajr && now <= maghrib) {
                const totalFast = maghrib - fajr;
                const elapsedFast = now - fajr;
                const percent = elapsedFast / totalFast;
                
                if (percent < 0.3) {
                    els.encouragingMessage.innerText = "Ø¨Ø¯Ø§ÙŠØ© ÙŠÙˆÙ… Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ø§Ù„Ø£Ø¬Ø±ØŒ ØªÙˆÙƒÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ù‡ ğŸ’ª";
                } else if (percent < 0.7) {
                    els.encouragingMessage.innerText = "Ø§Ù†ØªØµÙØª Ø±Ø­Ù„Ø© Ø§Ù„ÙŠÙˆÙ…ØŒ Ø§Ù„ØµØ¨Ø± Ù…ÙØªØ§Ø­ Ø§Ù„ÙØ±Ø¬ â³";
                } else if (percent < 0.95) {
                    els.encouragingMessage.innerText = "Ø§Ù‚ØªØ±Ø¨ Ø§Ù„Ù…ÙˆØ¹Ø¯.. Ø¬Ù‡Ù‘Ø² Ø¯Ø¹ÙˆØ§ØªÙƒ Ø§Ù„ØªÙŠ Ù„Ø§ ØªØ±Ø¯ ğŸ¤²";
                } else {
                    els.encouragingMessage.innerText = "Ù„Ø­Ø¸Ø§Øª ØªÙØµÙ„Ù†Ø§ Ø¹Ù† Ø£Ø¬Ø± Ø¹Ø¸ÙŠÙ…ØŒ ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ ØµÙŠØ§Ù…Ùƒ âœ¨";
                }
            } else {
                els.encouragingMessage.innerText = "ØµÙˆÙ…Ø§Ù‹ Ù…Ù‚Ø¨ÙˆÙ„Ø§Ù‹ ÙˆØ¥ÙØ·Ø§Ø±Ø§Ù‹ Ø´Ù‡ÙŠØ§Ù‹ØŒ Ù„Ø§ ØªÙ†Ø³Ù†Ø§ Ù…Ù† Ø¯Ø¹Ø§Ø¦Ùƒ ğŸ½ï¸";
            }
        }

        function updateTick() {
            if (typeof adhan === 'undefined') return;
            const now = new Date();
            const prayerTimes = new adhan.PrayerTimes(coords, now, params);

            if (window.nextPrayerTime) {
                const diff = window.nextPrayerTime - now;
                if (diff > 0) {
                    const h = Math.floor(diff / (1000 * 60 * 60));
                    const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                    const s = Math.floor((diff % (1000 * 60)) / 1000);
                    els.countdown.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                } else {
                    els.countdown.innerText = "00:00:00";
                    updateDashboard(); 
                }
            }

            const fajr = prayerTimes.fajr;
            const maghrib = prayerTimes.maghrib;
            
            updateEncouragement(now, fajr, maghrib);

            if (now >= fajr && now <= maghrib) {
                const totalFast = maghrib - fajr;
                const elapsedFast = now - fajr;
                const percent = (elapsedFast / totalFast) * 100;
                els.fastingPercent.innerText = percent.toFixed(6) + '%';
                els.fastingBar.style.width = percent + '%';
                els.celebration.style.display = 'none';
            } else if (now > maghrib) {
                els.fastingPercent.innerText = '100.000000%';
                els.fastingBar.style.width = '100%';
                if (now - maghrib < 15 * 60000) {
                    els.celebration.style.display = 'block';
                    if(els.celebration.innerHTML === '') createConfetti();
                } else {
                    els.celebration.style.display = 'none';
                }
            } else {
                els.fastingPercent.innerText = '0.000000%';
                els.fastingBar.style.width = '0%';
                els.celebration.style.display = 'none';
            }

            const ramadanStart = new Date('2026-02-19T00:00:00'); 
            let ramadanDay = Math.floor((now - ramadanStart) / (1000 * 60 * 60 * 24)) + 1;
            if (ramadanDay < 1) ramadanDay = 1;
            if (ramadanDay > 30) ramadanDay = 30;
            let monthPercent = (ramadanDay / 30) * 100;
            els.ramadanDaysText.innerText = `Ø§Ù„ÙŠÙˆÙ… ${ramadanDay} Ù…Ù† 30`;
            els.ramadanMonthPercent.innerText = monthPercent.toFixed(2) + '%';
            els.ramadanMonthBar.style.width = monthPercent + '%';

            updateWorkTracker(now);
        }

        function updateWorkTracker(now) {
            const day = now.getDay(); 
            if (day === 5 || day === 6) {
                els.workCountdown.innerText = "Ø¥Ø¬Ø§Ø²Ø©";
                els.workCountdown.style.fontSize = "2.5rem";
                els.workStatusLabel.innerText = "Ø¹Ø·Ù„Ø© Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ - ØªÙ‚Ø¨Ù„ Ø§Ù„Ù„Ù‡ Ø·Ø§Ø¹Ø§ØªÙƒÙ…";
                els.workPercent.innerText = "0.000000%";
                els.workBar.style.width = "0%";
                return;
            }

            els.workCountdown.style.fontSize = "3.5rem";

            const workStart = new Date(now);
            const [startH, startM] = workStartTimeStr.split(':');
            workStart.setHours(parseInt(startH), parseInt(startM), 0, 0);
            
            const workEnd = new Date(now);
            const [endH, endM] = workEndTimeStr.split(':');
            workEnd.setHours(parseInt(endH), parseInt(endM), 0, 0);

            if (now < workStart) {
                const diff = workStart - now;
                const h = Math.floor(diff / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);
                els.workCountdown.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                els.workStatusLabel.innerText = "Ù…ØªØ¨Ù‚ÙŠ Ù„Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ø¯ÙˆØ§Ù…";
                els.workPercent.innerText = '0.000000%';
                els.workBar.style.width = '0%';
            } else if (now >= workStart && now <= workEnd) {
                const totalWork = workEnd - workStart;
                const elapsedWork = now - workStart;
                const percent = (elapsedWork / totalWork) * 100;
                
                els.workPercent.innerText = percent.toFixed(6) + '%';
                els.workBar.style.width = percent + '%';

                const diff = workEnd - now;
                const h = Math.floor(diff / (1000 * 60 * 60));
                const m = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const s = Math.floor((diff % (1000 * 60)) / 1000);
                els.workCountdown.innerText = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
                els.workStatusLabel.innerText = "Ù…ØªØ¨Ù‚ÙŠ Ù„Ù†Ù‡Ø§ÙŠØ© Ø¯ÙˆØ§Ù…Ùƒ";
            } else {
                els.workCountdown.innerText = "00:00:00";
                els.workStatusLabel.innerText = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¯ÙˆØ§Ù…! ÙŠØ¹Ø·ÙŠÙƒ Ø§Ù„Ø¹Ø§ÙÙŠØ©";
                els.workPercent.innerText = '100.000000%';
                els.workBar.style.width = '100%';
            }
        }

        function createConfetti() {
            for(let i=0; i<50; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.animationDuration = (Math.random() * 3 + 2) + 's';
                confetti.style.backgroundColor = ['#fbbf24', '#3b82f6', '#ffffff'][Math.floor(Math.random()*3)];
                els.celebration.appendChild(confetti);
            }
        }

        init();
    </script>
</body>
</html>
